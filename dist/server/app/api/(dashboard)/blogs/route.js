(()=>{var e={};e.id=761,e.ids=[761],e.modules={6037:e=>{"use strict";e.exports=require("mongoose")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},626:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>I,routeModule:()=>m,serverHooks:()=>x,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>f});var r={};s.r(r),s.d(r,{GET:()=>l,POST:()=>y});var n=s(2706),a=s(8203),i=s(5994),o=s(9187),d=s(2545),u=s(6288),g=s(6037),p=s(2319),c=s(5392);let l=async e=>{try{let{searchParams:t}=new URL(e.url),s=t.get("userId"),r=t.get("categoryId"),n=t.get("keywords"),a=t.get("startDate"),i=t.get("endDate"),l=parseInt(t.get("page")||"1"),y=parseInt(t.get("limit")||"10");if(!s||!g.Types.ObjectId.isValid(s))return new o.NextResponse(JSON.stringify({message:"Invalid or missing userId"}),{status:400});if(!r||!g.Types.ObjectId.isValid(r))return new o.NextResponse(JSON.stringify({message:"Invalid or missing categoryId"}),{status:400});if(await (0,d.A)(),!await p.A.findById(s))return new o.NextResponse(JSON.stringify({message:"User not found"}),{status:404});if(!await c.A.findById(r))return new o.NextResponse(JSON.stringify({message:"Category not found"}),{status:404});let m={user:new g.Types.ObjectId(s),category:new g.Types.ObjectId(r)};n&&(m.$or=[{title:{$regex:n,$options:"i"}},{description:{$regex:n,$options:"i"}}]),a&&i?m.createdAt={$gte:new Date(a),$lte:new Date(i)}:a?m.createdAt={$gte:new Date(a)}:i&&(m.createdAt={$lte:new Date(i)});let w=await u.A.find(m).sort({createdAt:"asc"}).skip((l-1)*y).limit(y);return new o.NextResponse(JSON.stringify({blogs:w}),{status:200})}catch(e){return new o.NextResponse("Error in fetching blogs"+e.message,{status:500})}},y=async e=>{try{let{searchParams:t}=new URL(e.url),s=t.get("userId"),r=t.get("categoryId"),{title:n,description:a}=await e.json();if(!s||!g.Types.ObjectId.isValid(s))return new o.NextResponse(JSON.stringify({message:"Invalid or missing userId"}),{status:400});if(!r||!g.Types.ObjectId.isValid(r))return new o.NextResponse(JSON.stringify({message:"Invalid or missing categoryId"}),{status:400});if(await (0,d.A)(),!await p.A.findById(s))return new o.NextResponse(JSON.stringify({message:"User not found"}),{status:404});if(!await c.A.findById(r))return new o.NextResponse(JSON.stringify({message:"Category not found"}),{status:404});let i=new u.A({title:n,description:a,user:new g.Types.ObjectId(s),category:new g.Types.ObjectId(r)});return await i.save(),new o.NextResponse(JSON.stringify({message:"Blog is created",blog:i}),{status:200})}catch(e){return new o.NextResponse("Error in fetching blogs"+e.message,{status:500})}},m=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/(dashboard)/blogs/route",pathname:"/api/blogs",filename:"route",bundlePath:"app/api/(dashboard)/blogs/route"},resolvedPagePath:"C:\\Users\\MARK\\Desktop\\PROJECTS\\JAVASCRIPT\\blogs\\app\\api\\(dashboard)\\blogs\\route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:w,workUnitAsyncStorage:f,serverHooks:x}=m;function I(){return(0,i.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:f})}},6487:()=>{},8335:()=>{},2545:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var r=s(6037),n=s.n(r);let a=process.env.MONGODB_URI,i=async()=>{let e=n().connection.readyState;if(1===e){console.log("Already connected");return}if(2===e){console.log("Connecting...");return}try{n().connect(a,{dbName:"BLOGS",bufferCommands:!0}),console.log("Connected")}catch(e){throw console.log("Error: ",e),Error("Error: ",e)}}},6288:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(6037);let n=new r.Schema({title:{type:"string",required:!0},description:{type:"string"},user:{type:r.Schema.Types.ObjectId,ref:"User"},category:{type:r.Schema.Types.ObjectId,ref:"Category"}},{timestamps:!0}),a=r.models.Blog||(0,r.model)("Blog",n)},5392:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(6037);let n=new r.Schema({title:{type:"string",required:!0},user:{type:r.Schema.Types.ObjectId,ref:"User"}},{timestamps:!0}),a=r.models.Category||(0,r.model)("Category",n)},2319:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(6037);let n=new r.Schema({email:{type:"string",required:!0,unique:!0},username:{type:"string",required:!0,unique:!0},password:{type:"string",required:!0}},{timestamps:!0}),a=r.models.User||(0,r.model)("User",n)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,452],()=>s(626));module.exports=r})();